<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Thinkora | Herramientas</title>

<link href="https://fonts.googleapis.com/css2?family=Righteous&family=Comfortaa:wght@300;400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="assets/css/styles.css">

<style>

/* ============================
   SECCIÓN
============================ */

.tools-main h1{
  font-family:'Righteous', cursive;
  font-size:2.6rem;
  margin-bottom:10px;
}

.tools-main p{
  color:var(--text-muted);
  max-width:800px;
  margin:0 auto 50px;
}

/* ============================
   GRID
============================ */

.tools-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:25px;
}

/* ============================
   TARJETAS THINKORA
============================ */

.tool-card{
  background:var(--bg-card);
  border:1px solid var(--border-soft);
  padding:30px 20px;
  border-radius:18px;
  text-decoration:none;
  color:var(--text-main);
  font-weight:600;
  transition:.3s ease;
  cursor:pointer;
}

.tool-card:hover{
  transform:translateY(-6px);
  border-color:var(--accent-blue);
  box-shadow:0 10px 25px rgba(0,168,198,.2);
}

.highlight-card{
  background:var(--gradient-main);
  color:#0b0b0b;
  font-weight:800;
}

/* ============================
   MODAL
============================ */

.modal{
  display:none;
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.75);
  backdrop-filter:blur(6px);
  justify-content:center;
  align-items:center;
  z-index:2000;
}

.modal-content{
  background:var(--bg-dark);
  padding:35px;
  border-radius:20px;
  width:90%;
  max-width:500px;
  text-align:left;
}

.modal-content h2{
  text-align:center;
  margin-bottom:20px;
}

.form-group{
  margin-bottom:15px;
}

label{
  display:block;
  margin-bottom:6px;
  font-size:.9rem;
  color:var(--text-muted);
}

input, select{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:1px solid var(--border-soft);
  background:var(--bg-card);
  color:var(--text-main);
}

button{
  margin-top:15px;
  width:100%;
  padding:12px;
  border:none;
  border-radius:10px;
  font-weight:700;
  cursor:pointer;
  background:var(--gradient-main);
  color:#0b0b0b;
}

.close-btn{
  margin-top:10px;
  background:#444;
  color:white;
}

</style>
</head>

<body>

<div id="navbar-container"></div>

<main class="tools-main">

<h1 data-i18n="toolsPage.title"></h1>
<p data-i18n="toolsPage.intro"></p>

<div class="tools-grid">

   <div class="tool-card" onclick="requestAccess('cotizador')">Cotizador</div>
   <div class="tool-card" onclick="requestAccess('verCotizaciones')">Ver Cotizaciones</div>
   <div class="tool-card" onclick="requestAccess('propuesta')">Generador Propuesta Técnica</div>
   <div class="tool-card" onclick="requestAccess('verPropuesta')">Ver Propuestas Técnicas</div>
   <div class="tool-card" onclick="requestAccess('contratos')">Contratos</div>
   <div class="tool-card" onclick="requestAccess('agentes')">Presentación Agentes</div>
  <a class="tool-card" href="https://platform-robs.github.io/THINKORA/dev.html">Generador QR</a>

  <div class="tool-card" onclick="openPortfolio()">Portafolio</div>

  <div class="tool-card highlight-card" onclick="openRegister()">Crear Usuario</div>

</div>

</main>

<!-- ================= REGISTRO ================= -->

<div class="modal" id="registerModal">
<div class="modal-content">

<h2>Unirse al equipo Thinkora</h2>

<form id="registerForm">

<div class="form-group">
<label>Nombre</label>
<input name="nombre" required>
</div>

<div class="form-group">
<label>Apellido Paterno</label>
<input name="apellidoP" required>
</div>

<div class="form-group">
<label>Apellido Materno</label>
<input name="apellidoM" required>
</div>

<div class="form-group">
<label>Teléfono (10 dígitos)</label>
<input name="telefono" type="tel" pattern="[0-9]{10}" required>
</div>

<div class="form-group">
<label>Correo</label>
<input name="correo" type="email" required>
</div>

<div class="form-group">
<label>Contraseña</label>
<input name="password" type="password" required>
</div>

<div class="form-group">
<label>Confirmar Contraseña</label>
<input name="confirmPassword" type="password" required>
</div>

<div class="form-group">
<label>Equipo</label>
<select name="equipo" required>
<option value="">Selecciona</option>
<option value="Sales">Sales</option>
<option value="Tech">Tech</option>
</select>
</div>

<button type="submit">Enviar Solicitud</button>
<button type="button" class="close-btn" onclick="closeRegister()">Cerrar</button>

</form>

</div>
</div>


<!-- ================= LOGIN ================= -->

<div class="modal" id="loginModal">
  <div class="modal-content">

    <h2>Acceso requerido</h2>

    <div class="form-group">
      <label>ID</label>
      <input type="text" id="loginId">
    </div>

    <div class="form-group">
      <label>Contraseña</label>
      <input type="password" id="loginPassword">
    </div>

    <button onclick="validateAccess()">Ingresar</button>
    <button class="close-btn" onclick="closeLogin()">Cerrar</button>

  </div>
</div>

   
<script>

const WEBAPP_URL = "https://script.google.com/macros/s/AKfycbxGcyul5yuzawrEt-IimLrIjx7AzU_-LMcadyNYsv7Pd470OzdJVbf5Z7aRvkc3TA/exec";
let selectedTool = "";

/* =============================
   ABRIR LOGIN
============================= */

function requestAccess(tool){
  selectedTool = tool;
  document.getElementById("loginModal").style.display="flex";
}

function closeLogin(){
  document.getElementById("loginModal").style.display="none";
}

/* =============================
   VALIDAR LOGIN
============================= */

async function validateAccess(){

  const id = document.getElementById("loginId").value;
  const password = document.getElementById("loginPassword").value;

  const res = await fetch(WEBAPP_URL,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({
      action:"login",
      id:id,
      password:password,
      tool:selectedTool
    })
  });

  const data = await res.json();

  if(!data.success){
    alert("Acceso denegado");
    return;
  }

  // SI TODO ES CORRECTO
  window.location.href="https://platform-robs.github.io/THINKORA/dev.html";
}

/* =============================
   REGISTRO
============================= */

function openRegister(){
  document.getElementById("registerModal").style.display="flex";
}

function closeRegister(){
  document.getElementById("registerModal").style.display="none";
}

document.getElementById("registerForm").addEventListener("submit", async function(e){

  e.preventDefault();

  const form = e.target;

  if(form.password.value !== form.confirmPassword.value){
    alert("Las contraseñas no coinciden");
    return;
  }

  if(!/^[0-9]{10}$/.test(form.telefono.value)){
    alert("El teléfono debe tener 10 dígitos");
    return;
  }

  await fetch(WEBAPP_URL,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({
      action:"register",
      nombre:form.nombre.value,
      apellidoP:form.apellidoP.value,
      apellidoM:form.apellidoM.value,
      telefono:form.telefono.value,
      correo:form.correo.value,
      password:form.password.value,
      equipo:form.equipo.value
    })
  });

  alert("Solicitud enviada correctamente");
  closeRegister();

});

/* MAYÚSCULAS */
document.querySelectorAll("input[name='nombre'], input[name='apellidoP'], input[name='apellidoM']")
.forEach(input=>{
  input.addEventListener("input",()=>{
    input.value=input.value.toUpperCase();
  });
});

function openPortfolio(){
  window.location.href="https://platform-robs.github.io/THINKORA/dev.html";
}

</script>

</body>
</html>
