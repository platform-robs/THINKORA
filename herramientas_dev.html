<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Thinkora | Herramientas</title>

<link href="https://fonts.googleapis.com/css2?family=Righteous&family=Comfortaa:wght@300;400;700&display=swap" rel="stylesheet">

<style>
body{font-family:Comfortaa;background:#0f1115;color:white;margin:0}
.tools-main{padding:60px 20px;text-align:center}
.tools-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:20px;margin-top:40px}
.tool-card{background:#1a1d23;padding:25px;border-radius:16px;cursor:pointer;font-weight:600;transition:.3s}
.tool-card:hover{transform:translateY(-5px);background:#242833}
.highlight-card{background:#00c6ff;color:#000;font-weight:800}
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.7);justify-content:center;align-items:center}
.modal-content{background:#1a1d23;padding:30px;border-radius:20px;width:90%;max-width:400px}
input,select{width:100%;padding:10px;margin:8px 0;border-radius:8px;border:none}
button{width:100%;padding:10px;margin-top:10px;border:none;border-radius:8px;font-weight:bold;cursor:pointer}
.close-btn{background:#444;color:white}
.primary-btn{background:#00c6ff;color:black}
</style>
</head>

<body>

<main class="tools-main">
<h1>Herramientas Thinkora</h1>

<div class="tools-grid">
  <div class="tool-card" onclick="requestAccess('cotizador')">Cotizador</div>
  <div class="tool-card" onclick="requestAccess('verCotizaciones')">Ver Cotizaciones</div>
  <div class="tool-card highlight-card" onclick="openRegister()">Crear Usuario</div>
</div>
</main>

<!-- REGISTRO -->
<div class="modal" id="registerModal">
<div class="modal-content">
<h2>Registro</h2>
<form id="registerForm">
<input name="nombre" placeholder="Nombre" required>
<input name="apellidoP" placeholder="Apellido Paterno" required>
<input name="apellidoM" placeholder="Apellido Materno" required>
<input name="telefono" placeholder="Teléfono 10 dígitos" required>
<input name="correo" type="email" placeholder="Correo" required>
<input name="password" type="password" placeholder="Contraseña" required>
<input name="confirmPassword" type="password" placeholder="Confirmar contraseña" required>
<select name="equipo" required>
<option value="">Selecciona equipo</option>
<option value="Sales">Sales</option>
<option value="Tech">Tech</option>
</select>
<button type="submit" class="primary-btn">Enviar Solicitud</button>
<button type="button" class="close-btn" onclick="closeRegister()">Cerrar</button>
</form>
</div>
</div>

<!-- LOGIN -->
<div class="modal" id="loginModal">
<div class="modal-content">
<h2>Acceso</h2>
<input id="loginId" placeholder="ID">
<input id="loginPassword" type="password" placeholder="Contraseña">
<button onclick="validateAccess()" class="primary-btn">Ingresar</button>
<button onclick="closeLogin()" class="close-btn">Cerrar</button>
</div>
</div>

<script>

const WEBAPP_URL = "https://script.google.com/macros/s/AKfycbwkiusDPtzKcizYzRkQHwUEe6N9E3D2ATlnmGGBBeBykf7pmnSjJ5wroH-HVMjEkW25/exec";
let selectedTool = "";

/* MODALES */
function openRegister(){document.getElementById("registerModal").style.display="flex";}
function closeRegister(){document.getElementById("registerModal").style.display="none";}
function requestAccess(tool){selectedTool=tool;document.getElementById("loginModal").style.display="flex";}
function closeLogin(){document.getElementById("loginModal").style.display="none";}

/* REGISTRO */
document.getElementById("registerForm").addEventListener("submit", async function(e){
e.preventDefault();
const f=e.target;

if(f.password.value!==f.confirmPassword.value){
alert("Las contraseñas no coinciden");return;
}

try{
const res=await fetch(WEBAPP_URL,{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({
action:"register",
nombre:f.nombre.value,
apellidoP:f.apellidoP.value,
apellidoM:f.apellidoM.value,
telefono:f.telefono.value,
correo:f.correo.value,
password:f.password.value,
equipo:f.equipo.value
})
});
const data=await res.json();
alert("Solicitud enviada correctamente");
closeRegister();
}catch(err){
alert("Error de conexión con el servidor");
}
});

/* LOGIN */
async function validateAccess(){
const id=document.getElementById("loginId").value.trim();
const password=document.getElementById("loginPassword").value.trim();

if(!id||!password){alert("Ingresa ID y contraseña");return;}

try{
const res=await fetch(WEBAPP_URL,{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({
action:"login",
id:id,
password:password,
tool:selectedTool
})
});
const data=await res.json();

if(data.success){
alert(data.message);
closeLogin();
}else{
alert(data.message);
}
}catch(err){
alert("Error de conexión con el servidor");
}
}

</script>
</body>
</html>
